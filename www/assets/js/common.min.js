let Fn={},Evt={},getGeoLocation=($(()=>{document.addEventListener("touchstart",function(e){1<e.touches.length&&e.preventDefault()},{passive:!1});let t=0;document.addEventListener("touchend",function(e){var s=(new Date).getTime();s-t<=300&&(e.preventDefault(),document.body.style.transform="scale(1)",document.body.style.transformOrigin="0 0"),t=s},{passive:!1})}),Fn.doContDown=(e,n,r)=>{let l;var s=()=>{var s=Date.now(),s=e-s;if(s<=0)n.text("00:00:00"),l&&clearInterval(l),r&&r();else{var t=Math.floor(s/864e5),a=Math.floor(s/36e5%24),o=Math.floor(s/6e4%60),s=Math.floor(s/1e3%60);let e="";1<t?e+=t+"DAYS ":1===t&&(e+=t+"DAY "),e+=`${a.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}:`+s.toString().padStart(2,"0"),n.text(e)}};return s(),l=setInterval(s,1e3)},Evt.press=window.PointerEvent?"pointerdown":"ontouchstart"in window?"touchstart":"mousedown",Evt.release=window.PointerEvent?"pointerup":"ontouchstart"in window?"touchend":"mouseup",Fn.formatDistanceKm=(e=0)=>{let s=Number(e);return Number.isFinite(s)?(s=Math.abs(s)<1e-9?0:s)<1?Math.max(0,Math.round(1e3*s))+"m":Math.round(10*s)/10+"km":"---"},async(e=5,s=10)=>{let t=0,a={error_message:"現在地を取得できませんでした"};for(;t<e;)try{if((a=await new Promise((s,t)=>{navigator.geolocation.getCurrentPosition(e=>{s({lat:e.coords.latitude,lng:e.coords.longitude,accuracy:e.coords.accuracy})},e=>{switch(e.code){case e.PERMISSION_DENIED:t("位置情報のアクセスが拒否されました。");break;case e.POSITION_UNAVAILABLE:t("位置情報が利用できません。");break;case e.TIMEOUT:t("位置情報の取得がタイムアウトしました。");break;default:t("位置情報の取得に失敗しました。")}},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})})).accuracy<=s)return a;t++}catch(e){return a||{error_message:e}}return a}),getParam=e=>{e=new URLSearchParams(location.search).get(e);return e?decodeURIComponent(e):""},MAP=(Fn.getSearchKeywords=(e="")=>"string"!=typeof e?[]:e.normalize("NFKC").trim().split(/\s+/).filter(Boolean),Fn.getYmdJa=(e,s="ymd")=>{var t=new Date(e);switch(s){case"d":formatted=t.getDate()+"日";break;case"md":formatted=`${t.getMonth()+1}月${t.getDate()}日`;break;default:formatted=`${t.getFullYear()}年${t.getMonth()+1}月${t.getDate()}日`}return formatted},Fn.isPastDate=(e,s,t=!1)=>{"today"===s&&(s=null);let a=(e="today"===e?null:e)?new Date(e.replace(/-/g,"/")):new Date,o=s?new Date(s.replace(/-/g,"/")):new Date;return a=a.setHours(0,0,0,0),o=o.setHours(0,0,0,0),t?a<=o:a<o},Fn.loadJson=async e=>{try{var s=await fetch(e);if(s.ok)return await s.json();throw new Error("HTTPエラー: "+s.status)}catch(e){return console.error("JSON取得失敗:",e),null}},Fn.loadJsonMultiple=async e=>await Promise.all(e.map(e=>Fn.loadJson(e))),{}),IS_LOCALSTORAGE=(MAP.markers=[],MAP.z_index=0,MAP.createMarker=({map:e,id:s,lat:t,lng:a,z_index:o,content:n,func:r})=>{e=new MAP.advaned_marker({map:e,position:{lat:t,lng:a},zIndex:o,content:n});e.addListener("click",()=>{r&&r(s)}),e._meta={id:s,lat:t,lng:a,z_index:o},MAP.markers.push({id:s,marker:e})},MAP.showMarker=s=>{var e=MAP.markers.find(e=>e.id===+s);e&&(e.marker.map=MAP.gmap)},MAP.showAllMarkers=()=>{MAP.markers.forEach(e=>{e.marker.map=MAP.gmap})},MAP.hideMarker=s=>{var e=MAP.markers.find(e=>e.id===+s);e&&(e.marker.map=null)},MAP.hideAllMarkers=()=>{MAP.markers.forEach(e=>{e.marker.map=null})},MAP.removeMarker=s=>{var e=MAP.markers.findIndex(e=>e.id===+s);e&&(MAP.markers[e].marker.map=null,MAP.markers.splice(e,1))},MAP.removeAllMarkers=()=>{MAP.hideAllMarkers(),MAP.markers=[]},MAP.animateMarker=s=>{var e,t=MAP.markers.find(e=>e.id===+s);t&&(e=(t=t.marker).content,MAP.z_index++,t.zIndex=MAP.z_index,e.classList.remove("maps-marker-pop"),e.offsetWidth,e.classList.add("maps-marker-pop"))},MAP.removeClassMarker=(s,e)=>{var t=MAP.markers.find(e=>e.id===+s);t&&t.marker.content.classList.add(e)},MAP.removeClassMarker=(s,e)=>{var t=MAP.markers.find(e=>e.id===+s);t&&t.marker.content.classList.remove(e)},MAP.addClassAllMarkers=s=>{MAP.markers.forEach(e=>{e.marker.content.classList.add(s)})},MAP.removeClassAllMarkers=s=>{MAP.markers.forEach(e=>{e.marker.content.classList.remove(s)})},MAP.getCenter=()=>{var e=MAP.gmap.getCenter();return{lat:e.lat(),lng:e.lng()}},MAP.panTo=(e,s)=>{e=MAP.normalizeLatLng(e,s);e&&MAP.gmap.panTo(e)},MAP.getCenterAfterChanged=s=>{MAP.gmap.addListener("idle",()=>{var e=MAP.getCenter();s(e.lat,e.lng)})},MAP.getAddressFromLatLng=(s,t)=>new Promise((a,e)=>{(new google.maps.Geocoder).geocode({location:{lat:s,lng:t}},(s,t)=>{if("OK"===t&&s[0]){let e=s[0].formatted_address;e.startsWith("日本")&&(e=(e=(e=(e=(e=e.replace(/^日本、?/,"")).replace(/〒\d{3}-\d{4}\s*/,"")).split(/[ー−-]/)[0]).trim()).replace(/[０-９]/g,e=>String.fromCharCode(e.charCodeAt(0)-65248))),a({status:t,str:e})}else e({status:t})})}),MAP.normalizeLatLng=(e,s)=>{e=Number(e),s=Number(s);return!Number.isFinite(e)||!Number.isFinite(s)||e<-90||90<e||s<-180||180<s?null:{lat:e,lng:s}},Fn.mapGetDistance=(e,s,t,a)=>{var o=e=>e*Math.PI/180,n=o(t-e),a=o(a-s),s=Math.sin(n/2)*Math.sin(n/2)+Math.cos(o(e))*Math.cos(o(t))*Math.sin(a/2)*Math.sin(a/2);return 6371*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))},Fn.matchByKeywords=(e="",s=[],t="AND")=>{if(!Array.isArray(s)||0===s.length)return!0;let a=e||"",o="OR"===t?"OR":"AND";return"AND"==o?s.every(e=>a.includes(Fn.textNormalizeForSearch(e))):s.some(e=>a.includes(Fn.textNormalizeForSearch(e)))},$(()=>{$(document).on(Evt.release,".js-propagation",e=>{e.stopPropagation()})}),Fn.shuffle=(e=[],s)=>{var t=s?e:[...e];let a,o;for(a=t.length;1<a;a--)o=Math.floor(Math.random()*a),[t[o],t[a-1]]=[t[a-1],t[o]];return t},Fn.slide={},Fn.slide.is_touch="ontouchstart"in window&&"ontouchend"in window||navigator.msPointerEnabled,Fn.slide.start=Fn.slide.is_touch?"touchstart":"mousedown",Fn.slide.move=Fn.slide.is_touch?"touchmove":"mousemove",Fn.slide.end=Fn.slide.is_touch?"touchend":"mouseup",Fn.slide.leave=Fn.slide.is_touch?"touchleave":"mouseleave",Fn.slide.is_session="sessionStorage"in window&&null!==window.sessionStorage,Fn.slide.storage=(s,e)=>{let t=null;if(Fn.slide.is_session&&void 0!==s)if(void 0!==e)sessionStorage[s]="object"==typeof e?JSON.stringify(e):e;else try{t=new Function("return "+sessionStorage[s])()}catch(e){t=sessionStorage[s]}return t},Fn.slide.storageDel=e=>{sessionStorage.removeItem(e)},Fn.slide.show=(t=".slideshow",e={})=>{let a=$(t),o=$(".slideshow__flex",a),s=$(".slideshow__unit",a),n=$(".js-slide-nav",a),r=$("a",n),l=e.t?$(".js-slide-link",e.t):$(".js-slide-link"),i=e.interval||!1===e.interval?e.interval:3e3,c=e.before,p=e.after,d=e.click,h=e.is_keyboard,u=[],m,g,v,f,j=0,w=e.no||1,k,b,y,P,_,M,A,S,F,x=s.width(),C=(0===x&&setTimeout(()=>{x=s.width()},1),Fn.slide.storage(t)&&(w=Fn.slide.storage(t),Fn.slide.storageDel(t)),$("img",a).attr("draggable","false"),()=>{var e=s.width();c&&c(),0!=e&&(x=e),o.stop().animate({left:x*(w-1)*-1},()=>{p&&p()}),T()}),T=()=>{1<s.length?(a.attr("data-no",w),0<r.length&&(r.removeClass("on"),$('[data-nav="'+w+'"]',a).addClass("on"))):n.remove()},D=e=>{switch(e){case"next":(w+=1)>j&&(w=1);break;case"prev":(w-=1)<1&&(w=j)}},E=()=>{f&&clearTimeout(f),f=setTimeout(()=>{g&&(D("next"),C()),E()},i)};!h&&1!==$(".slideshow").length||document.addEventListener("keydown",e=>{switch(e.key){case"ArrowLeft":i&&E(),D("prev"),C();break;case"ArrowRight":i&&E(),D("next"),C()}return!1}),$(window).on("resize",()=>{x=s.width(),o.css("left",x*(w-1)*-1)}),r.on("click",function(){var e=$(this).attr("data-nav")||"next";return g=!1,"prev"===e||"next"===e?D(e):w=+e,C(),!1}),l.on("click",function(){var e=$(this).attr("data-nav")||"next";return g=!1,"prev"===e||"next"===e?D(e):w=+e,C(),!1});j=s.length,s.each(function(){var e=$(this).attr("data-href");e&&""!=e?u.push(e):u.push(null)}),o.css("left",x*(w-1)*-1),T(),(()=>{let s=()=>{m=!1,v&&clearTimeout(v),v=setTimeout(()=>{!m&&i&&(g=!0)},i)};a.on(Fn.slide.start,e=>{m=!1,g=!1,k=(Fn.slide.is_touch?e.touches[0]:e).pageX,b=(Fn.slide.is_touch?e.touches[0]:e).pageY,y=k,P=b}).on(Fn.slide.end,e=>{A=y-_,S=P-M,m?(Math.abs(S)<50&&(50<A?D("next"):A<-50&&D("prev"),C(),e.preventDefault()),s()):(d&&d(),u[w-1]&&(Fn.slide.storage(t,w),location.href=u[w-1]))}).on(Fn.slide.leave,s).on(Fn.slide.move,e=>{m=!0,_=(Fn.slide.is_touch?e.touches[0]:e).pageX,M=(Fn.slide.is_touch?e.touches[0]:e).pageY,A=y-_,S=P-M,50<Math.abs(A)&&(o.css({left:F-(k-_)}),k=_,e.preventDefault())})})(),i&&(g=!0,E())},"localStorage"in window&&null!==window.localStorage),IS_SESSIONSTORAGE="sessionStorage"in window&&null!==window.sessionStorage,Photos=(Fn.storageLS=(s,e)=>{let t=null;if(IS_LOCALSTORAGE&&void 0!==s)if(void 0!==e)localStorage[s]="object"==typeof e?JSON.stringify(e):e;else try{t=new Function("return "+localStorage[s])()}catch(e){t=localStorage[s]}return t},Fn.storageDelLS=e=>{localStorage.removeItem(e)},Fn.storageSS=(s,e)=>{let t=null;if(IS_SESSIONSTORAGE&&void 0!==s)if(void 0!==e)sessionStorage[s]="object"==typeof e?JSON.stringify(e):e;else try{t=new Function("return "+sessionStorage[s])()}catch(e){t=sessionStorage[s]}return t},Fn.storageDelSS=e=>{sessionStorage.removeItem(e)},Fn.textNormalizeForSearch=(e="")=>"string"!=typeof e?"":e.normalize("NFKC").toLowerCase().replace(/[\u30a1-\u30f6]/g,e=>String.fromCharCode(e.charCodeAt(0)-96)).replace(/ー/g,"").replace(/\s+/g,"").replace(/ゔぁ/g,"ば").replace(/ゔぃ/g,"び").replace(/ゔぇ/g,"べ").replace(/ゔぉ/g,"ぼ").replace(/ゔ/g,"ぶ").replace(/[・,，.．]/g,""),{}),getCreateUser=(Photos.likes={},Photos.ls=Fn.storageLS("photowalk")||{},$(()=>{$(".js-page").html(page_init),""!=PARAM_EVENT_ID?$('.js-form-event input[name="id"]').val(PARAM_EVENT_ID):Photos.ls.event_id&&$('.js-form-event input[name="id"]').val(Photos.ls.event_id)}),$(()=>{$(document).on("submit",".js-form-event",function(){let e=$(this),t=$(".js-form-error",e),s=$('[name="id"]',e),a=s.val();return t.html("").css({visibility:"hidden"}),(async()=>{try{var e=await getEventInfoWithImages(a),s=new URLSearchParams(window.location.search);if("success"!=e.status)return!t.html(e.message).css({visibility:"visible"});Photos.event_id=a,Photos.photowalkers=e.photowalkers,Photos.ls.event_id=a,Fn.storageLS("photowalk",Photos.ls),s.set("event_id",a),history.replaceState(null,"","?"+s.toString()),$(".js-page").html(page_account).hide(),$(".js-account-title .ja").text(e.title_ja),$(".js-account-title .en").text(e.title_en),$(".js-account-time").text(e.date),$(".js-account-excerpt .ja").text(e.excerpt_ja),$(".js-account-excerpt .en").text(e.excerpt_en),$(".js-page").show(),Photos.ls.uid&&$('.js-form-account input[name="display_name"]').val(Photos.ls.uid)}catch(e){return!$(".js-page").html(page_error)}})(),!1}),$(document).on("click",".js-account-firsttime",()=>{$('.js-account[data-flow="1"]').hide(),$('.js-account[data-flow="2-1"]').show()}),$(document).on("click",".js-account-returning",()=>{$('.js-account[data-flow="1"]').hide(),$('.js-account[data-flow="2-2"]').show()}),$(document).on("click",".js-link-account",()=>{$(".js-account").hide(),$('.js-account[data-flow="1"]').show()}),$(document).on("click",".js-account-create",function(){$(this).replaceWith(`
      <button class="js-account-create-number">
        <span class="animation-blinker" style="font-size:14px;">
          <span class="ja">作成中...</span>
          <span class="en">Creating...</span>
        </span>
      </button>
    `),(async()=>{try{var e=await getCreateUser();if("success"!=e.status)return!$(".js-page").html(page_error);Photos.handle=e.uid,Photos.ls.uid=e.uid,Fn.storageLS("photowalk",Photos.ls),$(".js-account-create-number").replaceWith(`
          <p><strong>${e.uid}</strong></p>
          <p><button class="js-account-next" style="width:5em;">OK</button></p>
        `),$('.js-account[data-flow="1"]').hide(),$('.js-account[data-flow="2-1"]').show()}catch(e){return!$(".js-page").html(page_error)}})()}),Photos.showList=()=>{var e=Photos.is_list_fixed?Photos.photowalkers:Fn.shuffle(Photos.photowalkers,!0);let s="",t,a;for(Photos.is_list_fixed=!1,$(".js-page").html(page_list).hide(),t=0;t<e.length;t++){var o=e[t];s+=`
        <li>
          <a class="js-link-photowalker" data-name="${o.name}"><span>${o.name}</span></a>
        </li>
      `}if($(".js-photowalkers-list").html(s),Photos.likes)for(a in Photos.likes){var n=$(`.js-link-photowalker[data-name="${a}"]`).closest("li");n.addClass("selected"),$(".js-photowalkers-list").append(n)}$(".js-page").show()},$(document).on("click",".js-account-next",Photos.showList),$(document).on("submit",".js-form-account",function(){let e=$(this),s=$(".js-form-error",e),t=$('[name="display_name"]',e),a=t.val();return s.css({visibility:"hidden"}),(async()=>{try{var e=await getUser(a);if("success"!=e.status)return!s.html(e.message).css({visibility:"visible"});Photos.handle=e.user.handle,e.likes.forEach(e=>{var s=e.photowalker;Photos.likes[s]||(Photos.likes[s]=[]),Photos.likes[s].push(e.filename)}),Photos.showList(),Photos.ls.uid=e.user.handle,Fn.storageLS("photowalk",Photos.ls)}catch(e){return!$(".js-page").html(page_error)}})(),!1}),$(document).on("click",".js-link-photowalker",function(){let s=$(this).attr("data-name"),e=Photos.photowalkers.find(e=>e.name===s)?.images||[],t=Fn.shuffle(e),a="",o;for($(".js-page").html(page_photos).hide(),o=0;o<t.length;o++)a+=`<li data-filename="${t[o]}"><img src="./assets/photo.php?filename=${Photos.event_id}/${s}/${t[o]}" loading="lazy"></li>`;if($(".js-photos-list").html(a),Photos.selected_photowaker=s,Photos.likes&&Photos.likes[s]){for(o=0;o<Photos.likes[s].length;o++)$(`.js-photos-list li[data-filename="${Photos.likes[s][o]}"]`).addClass("selected");$(".js-photos-selected-num").html($(".js-photos-list li.selected").length)}0===$(".js-photos-list li.selected").length&&$(".js-photos-selected, .js-photos-submit").css({opacity:.3}),$(".js-page").show()}),$(document).on("click",".js-photos-list li",function(){var e=$(this),e=(e.hasClass("selected")?(e.addClass("temp"),e.removeClass("selected")):(e.removeClass("temp"),e.addClass("selected")),$(".js-photos-list li.selected").length),s=$(".js-photos-selected, .js-photos-submit");$(".js-photos-selected-num").html(e),0<e?s.css({opacity:1}):s.css({opacity:.3})}),$(document).on("click",".js-photos-layout",function(){var e="one"===$(".js-photos-list").attr("data-layout")?"column":"one";$(".js-photos-list").attr("data-layout",e)}),$(document).on("click",".js-photos-bg",()=>{var e=$(".js-photos"),s="white"===e.attr("data-bg")?"black":"white";e.attr("data-bg",s)}),$(document).on("click",".js-photos-selected",()=>{if(0===$(".js-photos-list li.selected").length)return!1;5<$(".js-photos-list li.selected").length?$(".js-photos-list-excerpt").addClass("show"):$(".js-photos-list-excerpt").removeClass("show"),$(".js-photos-list li.temp").removeClass("temp"),$(".js-photos").attr("data-type","submit"),window.scrollTo(0,1)}),$(document).on("submit",".js-form-submit",()=>(0!==$(".js-photos-list li.selected").length&&(5<$(".js-photos-list li.selected").length?($(".js-photos-toast").addClass("show").on("click",function(){$(this).removeClass("show")}),setTimeout(()=>{$(".js-photos-toast").removeClass("show")},3e3)):(async()=>{let e={};e.event_id=Photos.event_id,e.uid=Photos.handle,e.photowalker=Photos.selected_photowaker,e.images=[],$(".js-photos-list li.selected").each(function(){e.images.push($(this).attr("data-filename"))}),$(".js-page").html(page_loading);try{var s=await setLikes(e);if("success"!=s.status)return $(".js-page").html(page_error).hide(),$(".js-error").html(s.message),!$(".js-page").show();Photos.likes[e.photowalker]=e.images,$(".js-page").html(page_complete)}catch(e){return $(".js-page").html(page_error),!console.error("error",e)}})()),!1)),$(document).on("click",".js-photos-back",()=>{switch($(".js-photos").attr("data-type")){case"confirm":Photos.is_list_fixed=!0,Photos.showList();break;case"submit":$(".js-photos").attr("data-type","confirm"),$(".js-photos-list li").removeClass("temp")}}),$(document).on("click",".js-link-complete",Photos.showList)}),()=>$.ajax({url:"./assets/api/create_user.php",method:"POST",dataType:"json",data:{csrf_token:CSRF_TOKEN}})),getEventInfo=(e="")=>$.ajax({url:"./assets/api/event_info_db_only.php",method:"POST",dataType:"json",data:{event_id:e,csrf_token:CSRF_TOKEN}}),getEventInfoWithImages=(e="")=>$.ajax({url:"./assets/api/event_info.php",method:"POST",dataType:"json",data:{event_id:e,csrf_token:CSRF_TOKEN}}),getUser=(e="")=>$.ajax({url:"./assets/api/get_user.php",method:"POST",dataType:"json",data:{uid:e,event_id:Photos.event_id,csrf_token:CSRF_TOKEN}}),page_loading=`
<div class="flex-center">
  <span class="animation-blinker">loading...</span>
</div>
`,page_error=`
<div class="flex-center">
  <div class="error">
    <p class="js-error">
      <span class="ja">想定外のエラーが発生しました。<br>時間を置いてもう一度お試しください。</span>
      <span class="en">Something went wrong.<br>Please try again in a little while.</span>
    </p>
    <p><a href="/">はじめに戻る</a></p>
  </div>
</div>
`,page_init=`
<section class="flex-center">
  <div class="init">
    <h1>
      <span class="ja">自薦＆他薦で決める一枚</span>
      <span class="en">Chosen — By You, By Them</span>
    </h1>
    <div class="init-excerpt">
      <div class="ja">
        <p>「誰が」「どの写真」を選んだか分からないから、完全に自分視点になれるのがイイ！</p>
        <p>さっそくイベントIDを入力してはじめましょう！</p>
      </div>
      <div class="en">
        <p>Because you don’t know who chose which photo, you can fully experience it from your own perspective — and that’s what makes it great!</p>
        <p>Enter the Event ID and get started right away!</p>
      </div>
    </div>
    <form class="js-form-event">
      <div>
        <input type="text" name="id" value="">
        <button type="submit">
          <span class="ja">スタート</span>
          <span class="en">START</span>
        </button>
      </div>
      <p class="form-error js-form-error" style="visibility:hidden;"></p>
    </form>
  </div>
</section>
`,page_account=`
<section class="flex-center">
  <section class="account js-account" data-flow="1">
    <p class="bar2"><a class="bar2-link-back" onclick="location.href='./';">終了する</a></p>
    <hgroup>
      <h2 class="js-account-title"><span class="ja"></span><span class="en"></span></h2>
      <p class="js-account-time"></p>
    </hgroup>
    <div class="account-excerpt">
      <p class="js-account-excerpt" style="margin-bottom:10px;"><span class="ja"></span><span class="en"></span></p>

      <div class="ja">
        <p>選出方法ですが、自薦＆他薦で選出します。<br>フォトウォーカーごとに「おっ！」となった写真を選んで、一人ずつの一枚を決めましょう！</p>
        <p>投票IDはありますか？</p>
      </div>
      <div class="en">
        <p>For the selection method, we’ll accept both self-nominations and nominations by others.<br>For each photowalker, choose the photos that really catch your eye (“Wow!” photos) and decide on one photo per person.</p>
        <p>Do you have your voting ID?</p>
      </div>
    </div>
    <div class="flex-button">
      <button type="button" class="js-account-firsttime">
        <span class="ja">はじめて</span>
        <span class="en">First Time</span>
      </button>
      <button type="button" class="js-account-returning">
        <span class="ja">あります！</span>
        <span class="en">Returning</span>
      </button>
    </div>
  </section>

  <section class="account js-account" data-flow="2-1" style="display:none;">
    <p class="bar2"><a class="bar2-link-back js-link-account">戻る</a></p>
    <p>
      <span class="ja">あなたの投票IDを作成します。<br>再発行はできませんので、作成後はキャプチャ撮るとかどこかにメモしておいてくださいね。</span>
      <span class="en">We will create your voting ID.<br>It cannot be reissued, so please take a screenshot or note it down somewhere after it’s created.</span>
    </p>
    <p>
      <button type="button" class="js-account-create">
        <span class="ja">作成する</span>
        <span class="en">Create</span>
      </button>
    </p>
  </section>

  <section class="account js-account" data-flow="2-2" style="display:none;">
    <p class="bar2">
      <a class="bar2-link-back js-link-account">
        <span class="ja">戻る</span>
        <span class="en">Back</span>
      </a>
    </p>
    <form class="js-form-account">
      <h2>
        <span class="ja">投票ID</span>
        <span class="en">Vote ID</span>
      </h2>
      <div>
        <input type="text" name="display_name" value="">
        <button type="submit">
          <span class="ja">写真を見る</span>
          <span class="en">View Photos</span>
        </button>
      </div>
      <p class="form-error js-form-error" style="visibility:hidden;margin-bottom:10px;">投票IDが一致しません。<br>ID名を確かめてください。</p>
    </form>
  </section>
</section>
`,page_list=`
<section class="flex-center">
  <p class="bar2">
    <a class="bar2-link-back" onclick="location.href='./';">
      <span class="ja">終了する</span>
      <span class="en">Done</span>
    </a>
  </p>
  <div class="list">
    <h2>
      <span class="ja">フォトウォーカー</span>
      <span class="en">Photowalkers</span>
    </h2>
    <ul class="js-photowalkers-list"></ul>
    <p class="ja">ランダム未投票順</p>
  </div>
</section>
`,page_photos=`
<section class="photos js-photos" data-type="confirm" data-bg="white">
  <nav class="bar bar--top">
    <button type="button" class="icon-back js-photos-back"><span></span></button>
    <div>
      <button type="button" class="js-photos-layout">
        <span class="icon-column-and-one">
          <span class="icon-column">
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
          </span>
          <span class="icon-one">
            <span></span>
          </span>
        </span>
      </button>
      <button type="button" class="icon-bg js-photos-bg">
        <span class="icon-bg-inner">
          <span></span>
          <span></span>
        </span>
      </button>
    </div>
  </nav>
  <div class="photos-inner">
    <p class="photos-list-excerpt" data-type="confirm">
      <span class="ja">まずは「おっ！」となった写真をタップしてください。<br>右上のアイコンで表示切り替えもできます。</span>
      <span class="en">Choose the photo that caught your eye.</span>
    </p>
    <p class="photos-list-excerpt js-photos-list-excerpt" data-type="submit">
      <span class="ja">続いて、5枚に絞り込んでから投票してください。</span>
      <span class="en">If there are more than five images, please limit them to five.</span>
    </p>
    <ul class="photos-list js-photos-list" data-layout="column" data-bg="white"></ul>
  </div>
  <nav class="bar bar--bottom-confirm">
    <button type="button" class="photos-selected js-photos-selected">
      <span class="ja">選択した画像を確認する »</span>
      <span class="en">NEXT</span>
    </button>
  </nav>
  <nav class="bar bar--bottom-submit">
    <span>
      <span class="js-photos-selected-num">0</span> / 5
    </span>
    <form class="js-form-submit">
      <button type="submit" class="photos-selected js-photos-submit">
        <span class="ja">投票する</span>
        <span class="en">Vote</span>
      </button>
    </form>
  </nav>

  <div class="photos-toast js-photos-toast">5枚まで!!</div>
</section>
`,page_complete=`
<section class="flex-center">
  <div class="complete">
    <p>
      <span class="ja">ありがとうございます！<br>投票を受け付けました。</span>
      <span class="en">Thank you!</span>
    </p>
    <p>
      <button type="button" class="js-link-complete">
        <span class="ja">リストに戻る</span>
        <span class="en">Back to List</span>
      </button>
    </p>
  </div>
</section>
`,setEventInfo=e=>(e.append("csrf_token",CSRF_TOKEN),$.ajax({url:"./assets/api/set_event_info.php",method:"POST",dataType:"json",data:e,processData:!1,contentType:!1})),setLikes=(e={})=>(e.csrf_token=CSRF_TOKEN,$.ajax({url:"./assets/api/likes.php",method:"POST",dataType:"json",data:e}));