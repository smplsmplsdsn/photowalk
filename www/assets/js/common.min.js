let Fn={},Evt={},getGeoLocation=($(()=>{document.addEventListener("touchstart",function(s){1<s.touches.length&&s.preventDefault()},{passive:!1});let t=0;document.addEventListener("touchend",function(s){var e=(new Date).getTime();e-t<=300&&(s.preventDefault(),document.body.style.transform="scale(1)",document.body.style.transformOrigin="0 0"),t=e},{passive:!1})}),Evt.press=window.PointerEvent?"pointerdown":"ontouchstart"in window?"touchstart":"mousedown",Evt.release=window.PointerEvent?"pointerup":"ontouchstart"in window?"touchend":"mouseup",Fn.formatDistanceKm=(s=0)=>{let e=Number(s);return Number.isFinite(e)?(e=Math.abs(e)<1e-9?0:e)<1?Math.max(0,Math.round(1e3*e))+"m":Math.round(10*e)/10+"km":"---"},async(s=5,e=10)=>{let t=0,a={error_message:"現在地を取得できませんでした"};for(;t<s;)try{if((a=await new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(s=>{e({lat:s.coords.latitude,lng:s.coords.longitude,accuracy:s.coords.accuracy})},s=>{switch(s.code){case s.PERMISSION_DENIED:t("位置情報のアクセスが拒否されました。");break;case s.POSITION_UNAVAILABLE:t("位置情報が利用できません。");break;case s.TIMEOUT:t("位置情報の取得がタイムアウトしました。");break;default:t("位置情報の取得に失敗しました。")}},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})})).accuracy<=e)return a;t++}catch(s){return a||{error_message:s}}return a}),getParam=s=>{s=new URLSearchParams(location.search).get(s);return s?decodeURIComponent(s):""},MAP=(Fn.getSearchKeywords=(s="")=>"string"!=typeof s?[]:s.normalize("NFKC").trim().split(/\s+/).filter(Boolean),Fn.getYmdJa=(s,e="ymd")=>{var t=new Date(s);switch(e){case"d":formatted=t.getDate()+"日";break;case"md":formatted=`${t.getMonth()+1}月${t.getDate()}日`;break;default:formatted=`${t.getFullYear()}年${t.getMonth()+1}月${t.getDate()}日`}return formatted},Fn.isPastDate=(s,e,t=!1)=>{"today"===e&&(e=null);let a=(s="today"===s?null:s)?new Date(s.replace(/-/g,"/")):new Date,o=e?new Date(e.replace(/-/g,"/")):new Date;return a=a.setHours(0,0,0,0),o=o.setHours(0,0,0,0),t?a<=o:a<o},Fn.loadJson=async s=>{try{var e=await fetch(s);if(e.ok)return await e.json();throw new Error("HTTPエラー: "+e.status)}catch(s){return console.error("JSON取得失敗:",s),null}},Fn.loadJsonMultiple=async s=>await Promise.all(s.map(s=>Fn.loadJson(s))),{}),IS_LOCALSTORAGE=(MAP.markers=[],MAP.z_index=0,MAP.createMarker=({map:s,id:e,lat:t,lng:a,z_index:o,content:n,func:r})=>{s=new MAP.advaned_marker({map:s,position:{lat:t,lng:a},zIndex:o,content:n});s.addListener("click",()=>{r&&r(e)}),s._meta={id:e,lat:t,lng:a,z_index:o},MAP.markers.push({id:e,marker:s})},MAP.showMarker=e=>{var s=MAP.markers.find(s=>s.id===+e);s&&(s.marker.map=MAP.gmap)},MAP.showAllMarkers=()=>{MAP.markers.forEach(s=>{s.marker.map=MAP.gmap})},MAP.hideMarker=e=>{var s=MAP.markers.find(s=>s.id===+e);s&&(s.marker.map=null)},MAP.hideAllMarkers=()=>{MAP.markers.forEach(s=>{s.marker.map=null})},MAP.removeMarker=e=>{var s=MAP.markers.findIndex(s=>s.id===+e);s&&(MAP.markers[s].marker.map=null,MAP.markers.splice(s,1))},MAP.removeAllMarkers=()=>{MAP.hideAllMarkers(),MAP.markers=[]},MAP.animateMarker=e=>{var s,t=MAP.markers.find(s=>s.id===+e);t&&(s=(t=t.marker).content,MAP.z_index++,t.zIndex=MAP.z_index,s.classList.remove("maps-marker-pop"),s.offsetWidth,s.classList.add("maps-marker-pop"))},MAP.removeClassMarker=(e,s)=>{var t=MAP.markers.find(s=>s.id===+e);t&&t.marker.content.classList.add(s)},MAP.removeClassMarker=(e,s)=>{var t=MAP.markers.find(s=>s.id===+e);t&&t.marker.content.classList.remove(s)},MAP.addClassAllMarkers=e=>{MAP.markers.forEach(s=>{s.marker.content.classList.add(e)})},MAP.removeClassAllMarkers=e=>{MAP.markers.forEach(s=>{s.marker.content.classList.remove(e)})},MAP.getCenter=()=>{var s=MAP.gmap.getCenter();return{lat:s.lat(),lng:s.lng()}},MAP.panTo=(s,e)=>{s=MAP.normalizeLatLng(s,e);s&&MAP.gmap.panTo(s)},MAP.getCenterAfterChanged=e=>{MAP.gmap.addListener("idle",()=>{var s=MAP.getCenter();e(s.lat,s.lng)})},MAP.getAddressFromLatLng=(e,t)=>new Promise((a,s)=>{(new google.maps.Geocoder).geocode({location:{lat:e,lng:t}},(e,t)=>{if("OK"===t&&e[0]){let s=e[0].formatted_address;s.startsWith("日本")&&(s=(s=(s=(s=(s=s.replace(/^日本、?/,"")).replace(/〒\d{3}-\d{4}\s*/,"")).split(/[ー−-]/)[0]).trim()).replace(/[０-９]/g,s=>String.fromCharCode(s.charCodeAt(0)-65248))),a({status:t,str:s})}else s({status:t})})}),MAP.normalizeLatLng=(s,e)=>{s=Number(s),e=Number(e);return!Number.isFinite(s)||!Number.isFinite(e)||s<-90||90<s||e<-180||180<e?null:{lat:s,lng:e}},Fn.mapGetDistance=(s,e,t,a)=>{var o=s=>s*Math.PI/180,n=o(t-s),a=o(a-e),e=Math.sin(n/2)*Math.sin(n/2)+Math.cos(o(s))*Math.cos(o(t))*Math.sin(a/2)*Math.sin(a/2);return 6371*(2*Math.atan2(Math.sqrt(e),Math.sqrt(1-e)))},Fn.matchByKeywords=(s="",e=[],t="AND")=>{if(!Array.isArray(e)||0===e.length)return!0;let a=s||"",o="OR"===t?"OR":"AND";return"AND"==o?e.every(s=>a.includes(Fn.textNormalizeForSearch(s))):e.some(s=>a.includes(Fn.textNormalizeForSearch(s)))},$(()=>{$(document).on(Evt.release,".js-propagation",s=>{s.stopPropagation()})}),Fn.shuffle=(s=[],e)=>{var t=e?s:[...s];let a,o;for(a=t.length;1<a;a--)o=Math.floor(Math.random()*a),[t[o],t[a-1]]=[t[a-1],t[o]];return t},Fn.slide={},Fn.slide.is_touch="ontouchstart"in window&&"ontouchend"in window||navigator.msPointerEnabled,Fn.slide.start=Fn.slide.is_touch?"touchstart":"mousedown",Fn.slide.move=Fn.slide.is_touch?"touchmove":"mousemove",Fn.slide.end=Fn.slide.is_touch?"touchend":"mouseup",Fn.slide.leave=Fn.slide.is_touch?"touchleave":"mouseleave",Fn.slide.is_session="sessionStorage"in window&&null!==window.sessionStorage,Fn.slide.storage=(e,s)=>{let t=null;if(Fn.slide.is_session&&void 0!==e)if(void 0!==s)sessionStorage[e]="object"==typeof s?JSON.stringify(s):s;else try{t=new Function("return "+sessionStorage[e])()}catch(s){t=sessionStorage[e]}return t},Fn.slide.storageDel=s=>{sessionStorage.removeItem(s)},Fn.slide.show=(t=".slideshow",s={})=>{let a=$(t),o=$(".slideshow__flex",a),e=$(".slideshow__unit",a),n=$(".js-slide-nav",a),r=$("a",n),l=s.t?$(".js-slide-link",s.t):$(".js-slide-link"),i=s.interval||!1===s.interval?s.interval:3e3,c=s.before,p=s.after,h=s.click,d=s.is_keyboard,u=[],m,g,f,v,j=0,k=s.no||1,w,b,P,y,_,M,A,F,S,x=e.width(),C=(0===x&&setTimeout(()=>{x=e.width()},1),Fn.slide.storage(t)&&(k=Fn.slide.storage(t),Fn.slide.storageDel(t)),$("img",a).attr("draggable","false"),()=>{var s=e.width();c&&c(),0!=s&&(x=s),o.stop().animate({left:x*(k-1)*-1},()=>{p&&p()}),L()}),L=()=>{1<e.length?(a.attr("data-no",k),0<r.length&&(r.removeClass("on"),$('[data-nav="'+k+'"]',a).addClass("on"))):n.remove()},T=s=>{switch(s){case"next":(k+=1)>j&&(k=1);break;case"prev":(k-=1)<1&&(k=j)}},D=()=>{v&&clearTimeout(v),v=setTimeout(()=>{g&&(T("next"),C()),D()},i)};!d&&1!==$(".slideshow").length||document.addEventListener("keydown",s=>{switch(s.key){case"ArrowLeft":i&&D(),T("prev"),C();break;case"ArrowRight":i&&D(),T("next"),C()}return!1}),$(window).on("resize",()=>{x=e.width(),o.css("left",x*(k-1)*-1)}),r.on("click",function(){var s=$(this).attr("data-nav")||"next";return g=!1,"prev"===s||"next"===s?T(s):k=+s,C(),!1}),l.on("click",function(){var s=$(this).attr("data-nav")||"next";return g=!1,"prev"===s||"next"===s?T(s):k=+s,C(),!1});j=e.length,e.each(function(){var s=$(this).attr("data-href");s&&""!=s?u.push(s):u.push(null)}),o.css("left",x*(k-1)*-1),L(),(()=>{let e=()=>{m=!1,f&&clearTimeout(f),f=setTimeout(()=>{!m&&i&&(g=!0)},i)};a.on(Fn.slide.start,s=>{m=!1,g=!1,w=(Fn.slide.is_touch?s.touches[0]:s).pageX,b=(Fn.slide.is_touch?s.touches[0]:s).pageY,P=w,y=b}).on(Fn.slide.end,s=>{A=P-_,F=y-M,m?(Math.abs(F)<50&&(50<A?T("next"):A<-50&&T("prev"),C(),s.preventDefault()),e()):(h&&h(),u[k-1]&&(Fn.slide.storage(t,k),location.href=u[k-1]))}).on(Fn.slide.leave,e).on(Fn.slide.move,s=>{m=!0,_=(Fn.slide.is_touch?s.touches[0]:s).pageX,M=(Fn.slide.is_touch?s.touches[0]:s).pageY,A=P-_,F=y-M,50<Math.abs(A)&&(o.css({left:S-(w-_)}),w=_,s.preventDefault())})})(),i&&(g=!0,D())},"localStorage"in window&&null!==window.localStorage),IS_SESSIONSTORAGE="sessionStorage"in window&&null!==window.sessionStorage,Photos=(Fn.storageLS=(e,s)=>{let t=null;if(IS_LOCALSTORAGE&&void 0!==e)if(void 0!==s)localStorage[e]="object"==typeof s?JSON.stringify(s):s;else try{t=new Function("return "+localStorage[e])()}catch(s){t=localStorage[e]}return t},Fn.storageDelLS=s=>{localStorage.removeItem(s)},Fn.storageSS=(e,s)=>{let t=null;if(IS_SESSIONSTORAGE&&void 0!==e)if(void 0!==s)sessionStorage[e]="object"==typeof s?JSON.stringify(s):s;else try{t=new Function("return "+sessionStorage[e])()}catch(s){t=sessionStorage[e]}return t},Fn.storageDelSS=s=>{sessionStorage.removeItem(s)},Fn.textNormalizeForSearch=(s="")=>"string"!=typeof s?"":s.normalize("NFKC").toLowerCase().replace(/[\u30a1-\u30f6]/g,s=>String.fromCharCode(s.charCodeAt(0)-96)).replace(/ー/g,"").replace(/\s+/g,"").replace(/ゔぁ/g,"ば").replace(/ゔぃ/g,"び").replace(/ゔぇ/g,"べ").replace(/ゔぉ/g,"ぼ").replace(/ゔ/g,"ぶ").replace(/[・,，.．]/g,""),{}),getCreateUser=(Photos.ls=Fn.storageLS("photowalk")||{},$(()=>{$(".js-page").html(page_init),Photos.ls.event_name&&$('.js-form-event input[name="id"]').val(Photos.ls.event_name)}),$(()=>{$(document).on("submit",".js-form-event",function(){let s=$(this),e=$(".js-form-error",s),t=$('[name="id"]',s),a=t.val();return e.html("").css({visibility:"hidden"}),(async()=>{try{var s=await getEventInfo(a);if("success"!=s.status)return!e.html(s.message).css({visibility:"visible"});Photos.event_name=a,Photos.photowalkers=s.photowalkers,Photos.ls.event_name=a,Fn.storageLS("photowalk",Photos.ls),$(".js-page").html(page_account).hide(),$(".js-account-title").html(s.title),$(".js-account-time").html(s.date),$(".js-account-excerpt").html(s.excerpt),$(".js-page").show(),Photos.ls.uid&&$('.js-form-account input[name="display_name"]').val(Photos.ls.uid)}catch(s){return!$(".js-page").html(page_error)}})(),!1}),$(document).on("click",".js-account-firsttime",()=>{$('.js-account[data-flow="1"]').hide(),$('.js-account[data-flow="2-1"]').show()}),$(document).on("click",".js-account-returning",()=>{$('.js-account[data-flow="1"]').hide(),$('.js-account[data-flow="2-2"]').show()}),$(document).on("click",".js-link-account",()=>{$(".js-account").hide(),$('.js-account[data-flow="1"]').show()}),$(document).on("click",".js-account-create",function(){$(this).replaceWith(`
      <button class="js-account-create-number">
        <span class="animation-blinker" style="font-size:14px;">
          <span class="ja">作成中...</span>
          <span class="en">Creating...</span>
        </span>
      </button>
    `),(async()=>{try{var s=await getCreateUser();if("success"!=s.status)return!$(".js-page").html(page_error);Photos.handle=s.uid,Photos.ls.uid=s.uid,Fn.storageLS("photowalk",Photos.ls),$(".js-account-create-number").replaceWith(`
          <p><strong>${s.uid}</strong></p>
          <p><button class="js-account-next" style="width:5em;">OK</button></p>
        `),$('.js-account[data-flow="1"]').hide(),$('.js-account[data-flow="2-1"]').show()}catch(s){return!$(".js-page").html(page_error)}})()}),Photos.showList=()=>{var s=Photos.is_list_fixed?Photos.photowalkers:Fn.shuffle(Photos.photowalkers,!0);let e="",t,a;for(Photos.is_list_fixed=!1,$(".js-page").html(page_list).hide(),t=0;t<s.length;t++){var o=s[t];e+=`
        <li>
          <a class="js-link-photowalker" data-name="${o.name}"><span>${o.name}</span></a>
        </li>
      `}if($(".js-photowalkers-list").html(e),Photos.likes)for(a in Photos.likes){var n=$(`.js-link-photowalker[data-name="${a}"]`).closest("li");n.addClass("selected"),$(".js-photowalkers-list").append(n)}$(".js-page").show()},$(document).on("click",".js-account-next",Photos.showList),$(document).on("submit",".js-form-account",function(){let s=$(this),e=$(".js-form-error",s),t=$('[name="display_name"]',s),a=t.val();return e.css({visibility:"hidden"}),(async()=>{try{var s=await getUser(a);if("success"!=s.status)return!e.html(s.message).css({visibility:"visible"});Photos.handle=s.user.handle,Photos.likes=[],s.likes.forEach(s=>{var e=s.photowalker;Photos.likes[e]||(Photos.likes[e]=[]),Photos.likes[e].push(s.filename)}),Photos.showList(),Photos.ls.uid=s.user.handle,Fn.storageLS("photowalk",Photos.ls)}catch(s){return!$(".js-page").html(page_error)}})(),!1}),$(document).on("click",".js-link-photowalker",function(){let e=$(this).attr("data-name"),s=Photos.photowalkers.find(s=>s.name===e)?.images||[],t=Fn.shuffle(s),a="",o;for($(".js-page").html(page_photos).hide(),o=0;o<t.length;o++)a+=`<li data-filename="${t[o]}"><img src="./assets/photo.php?filename=${Photos.event_name}/${e}/${t[o]}" loading="lazy"></li>`;if($(".js-photos-list").html(a),Photos.selected_photowaker=e,Photos.likes&&Photos.likes[e]){for(o=0;o<Photos.likes[e].length;o++)$(`.js-photos-list li[data-filename="${Photos.likes[e][o]}"]`).addClass("selected");$(".js-photos-selected-num").html($(".js-photos-list li.selected").length)}0===$(".js-photos-list li.selected").length&&$(".js-photos-selected, .js-photos-submit").css({opacity:.3}),$(".js-page").show()}),$(document).on("click",".js-photos-list li",function(){var s=$(this),s=(s.hasClass("selected")?(s.addClass("temp"),s.removeClass("selected")):(s.removeClass("temp"),s.addClass("selected")),$(".js-photos-list li.selected").length),e=$(".js-photos-selected, .js-photos-submit");$(".js-photos-selected-num").html(s),0<s?e.css({opacity:1}):e.css({opacity:.3})}),$(document).on("click",".js-photos-layout",function(){var s="one"===$(".js-photos-list").attr("data-layout")?"column":"one";$(".js-photos-list").attr("data-layout",s)}),$(document).on("click",".js-photos-bg",()=>{var s=$(".js-photos"),e="white"===s.attr("data-bg")?"black":"white";s.attr("data-bg",e)}),$(document).on("click",".js-photos-selected",()=>{if(0===$(".js-photos-list li.selected").length)return!1;5<$(".js-photos-list li.selected").length?$(".js-photos-list-excerpt").addClass("show"):$(".js-photos-list-excerpt").removeClass("show"),$(".js-photos-list li.temp").removeClass("temp"),$(".js-photos").attr("data-type","submit"),window.scrollTo(0,1)}),$(document).on("submit",".js-form-submit",()=>(0!==$(".js-photos-list li.selected").length&&(5<$(".js-photos-list li.selected").length?($(".js-photos-toast").addClass("show").on("click",function(){$(this).removeClass("show")}),setTimeout(()=>{$(".js-photos-toast").removeClass("show")},3e3)):(async()=>{let s={};s.event_name=Photos.event_name,s.uid=Photos.handle,s.photowalker=Photos.selected_photowaker,s.images=[],$(".js-photos-list li.selected").each(function(){s.images.push($(this).attr("data-filename"))}),$(".js-page").html(page_loading);try{if("success"!=(await setLikes(s)).status)return!$(".js-page").html(page_error);Photos.likes[s.photowalker]=s.images,$(".js-page").html(page_complete)}catch(s){return $(".js-page").html(page_error),!console.error("error",s)}})()),!1)),$(document).on("click",".js-photos-back",()=>{switch($(".js-photos").attr("data-type")){case"confirm":Photos.is_list_fixed=!0,Photos.showList();break;case"submit":$(".js-photos").attr("data-type","confirm"),$(".js-photos-list li").removeClass("temp")}}),$(document).on("click",".js-link-complete",Photos.showList)}),()=>$.ajax({url:"./assets/api/create_user.php",method:"POST",dataType:"json",data:{csrf_token:CSRF_TOKEN}})),getEventInfo=(s="")=>$.ajax({url:"./assets/api/event_info.php",method:"POST",dataType:"json",data:{event_name:s,csrf_token:CSRF_TOKEN}}),getUser=(s="")=>$.ajax({url:"./assets/api/get_user.php",method:"POST",dataType:"json",data:{uid:s,event_name:Photos.event_name,csrf_token:CSRF_TOKEN}}),page_loading=`
<div class="flex-center">
  <span class="animation-blinker">loading...</span>
</div>
`,page_error=`
<div class="flex-center">
  <div class="error">
    <p>
      <span class="ja">想定外のエラーが発生しました。<br>時間を置いてもう一度お試しください。</span>
      <span class="en">Something went wrong.<br>Please try again in a little while.</span>
    </p>
    <p><a href="/">はじめに戻る</a></p>
  </div>
</div>
`,page_init=`
<section class="flex-center">
  <div class="init">
    <h1>自薦＆他薦で決める一枚</h1>
    <p class="init-excerpt">「誰が」「どの写真」を選んだか分からないから、完全に自分視点になれるのがイイ！</p>
    <form class="js-form-event">
      <div>
        <input type="text" name="id" value="" placeholder="イベントID">
        <button type="submit">
          <span class="ja">スタート</span>
          <span class="en">START</span>
        </button>
      </div>
      <p class="form-error js-form-error" style="visibility:hidden;"></p>
    </form>
  </div>
</section>
`,page_account=`
<section class="flex-center">
  <section class="account js-account" data-flow="1">
    <p class="bar2"><a class="bar2-link-back" onclick="location.href='./';">終了する</a></p>
    <hgroup>
      <h2 class="js-account-title"></h2>
      <p class="js-account-time"></p>
    </hgroup>
    <div class="account-excerpt">
      <p class="js-account-excerpt"></p>
      <div class="ja">
        <p>選出方法ですが、自薦＆他薦で選出したいと思います。<br>フォトウォーカーごとに「おっ！」となった写真を選んで、一人ずつの一枚を決めましょう！</p>
        <p>投票IDはありますか？</p>
      </div>
      <div class="en">
        <p>For the selection method, we’ll accept both self-nominations and nominations by others.<br>For each photowalker, choose the photos that really catch your eye (“Wow!” photos) and decide on one photo per person.</p>
        <p>Do you have your voting ID?</p>
      </div>
    </div>
    <div class="flex-button">
      <button type="button" class="js-account-firsttime">
        <span class="ja">はじめて</span>
        <span class="en">First Time</span>
      </button>
      <button type="button" class="js-account-returning">
        <span class="ja">あります！</span>
        <span class="en">Returning</span>
      </button>
    </div>
  </section>

  <section class="account js-account" data-flow="2-1" style="display:none;">
    <p class="bar2"><a class="bar2-link-back js-link-account">戻る</a></p>
    <p>
      <span class="ja">あなたの投票IDを作成します。<br>再発行はできませんので、作成後はキャプチャ撮るとかどこかにメモしておいてくださいね。</span>
      <span class="en">We will create your voting ID.<br>It cannot be reissued, so please take a screenshot or note it down somewhere after it’s created.</span>
    </p>
    <p>
      <button type="button" class="js-account-create">作成する</button>
    </p>
  </section>

  <section class="account js-account" data-flow="2-2" style="display:none;">
    <p class="bar2"><a class="bar2-link-back js-link-account">戻る</a></p>
    <form class="js-form-account">
      <h2>
        <span class="ja">投票ID</span>
        <span class="en">Vote ID</span>
      </h2>
      <div>
        <input type="text" name="display_name" value="">
        <button type="submit">
          <span class="ja">写真を見る</span>
          <span class="en">View Photos</span>
        </button>
      </div>
      <p class="form-error js-form-error" style="visibility:hidden;margin-bottom:10px;">投票IDが一致しません。<br>ID名を確かめてください。</p>
    </form>
  </section>
</section>
`,page_list=`
<section class="flex-center">
  <p class="bar2">
    <a class="bar2-link-back" onclick="location.href='./';">
      <span class="ja">終了する</span>
      <span class="en">done</span>
    </a>
  </p>
  <div class="list">
    <h2>
      <span class="ja">フォトウォーカー</span>
      <span class="en">Photowalkers</span>
    </h2>
    <ul class="js-photowalkers-list"></ul>
    <p class="ja">ランダム未投票順</p>
  </div>
</section>
`,page_photos=`
<section class="photos js-photos" data-type="confirm" data-bg="white">
  <nav class="bar bar--top">
    <button type="button" class="icon-back js-photos-back"><span></span></button>
    <div>
      <button type="button" class="js-photos-layout">
        <span class="icon-column-and-one">
          <span class="icon-column">
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
          </span>
          <span class="icon-one">
            <span></span>
          </span>
        </span>
      </button>
      <button type="button" class="icon-bg js-photos-bg">
        <span class="icon-bg-inner">
          <span></span>
          <span></span>
        </span>
      </button>
    </div>
  </nav>
  <div class="photos-inner">
    <p class="photos-list-excerpt" data-type="confirm">
      <span class="ja">まずは「おっ！」となった写真をタップしてください。<br>右上のアイコンで表示切り替えもできます。</span>
      <span class="en">Choose the photo that caught your eye.</span>
    </p>
    <p class="photos-list-excerpt js-photos-list-excerpt" data-type="submit">
      <span class="ja">続いて、5枚に絞り込んでから投票してください。</span>
      <span class="en">If there are more than five images, please limit them to five.</span>
    </p>
    <ul class="photos-list js-photos-list" data-layout="column" data-bg="white"></ul>
  </div>
  <nav class="bar bar--bottom-confirm">
    <button type="button" class="photos-selected js-photos-selected">
      <span class="ja">選択した画像を確認する »</span>
      <span class="en">NEXT</span>
    </button>
  </nav>
  <nav class="bar bar--bottom-submit">
    <span>
      <span class="js-photos-selected-num">0</span> / 5
    </span>
    <form class="js-form-submit">
      <button type="submit" class="photos-selected js-photos-submit">
        <span class="ja">投票する</span>
        <span class="en">Vote</span>
      </button>
    </form>
  </nav>

  <div class="photos-toast js-photos-toast">5枚まで!!</div>
</section>
`,page_complete=`
<section class="flex-center">
  <div class="complete">
    <p>
      <span class="ja">ありがとうございます！<br>投票を受け付けました。</span>
      <span class="en">Thank you!</span>
    </p>
    <p>
      <button type="button" class="js-link-complete">
        <span class="ja">リストに戻る</span>
        <span class="en">Back to List</span>
      </button>
    </p>
  </div>
</section>
`,setLikes=(s={})=>(s.csrf_token=CSRF_TOKEN,$.ajax({url:"./assets/api/likes.php",method:"POST",dataType:"json",data:s}));